<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Control Palo Alto GlobalProtect VPN using AppleScript | Trevor Manternach</title>
<link href="../../../../assets/css/all.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#d63900">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../../feed.xml">
<link rel="canonical" href="https://trevormanternach.com/2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Trevor Manternach">
<link rel="prev" href="../../04/home-assistant-quick-bar/" title="Home Assistant Quick Bar" type="text/html">
<link rel="next" href="../../../11/03/python-script-to-retrieve-dhcp-leases-from-palo-alto-firewall/" title="Python script to retrieve DHCP leases from Palo Alto firewall" type="text/html">
<meta property="og:site_name" content="Trevor Manternach">
<meta property="og:title" content="Control Palo Alto GlobalProtect VPN using AppleScript">
<meta property="og:url" content="https://trevormanternach.com/2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript/">
<meta property="og:description" content="I know it's a little strange to still be writing AppleScript in 2023, but this was the best way I found to easily connect and disconnect from a GlobalProtect VPN &quot;automatically&quot;. I trigger this from a">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-08-17T19:35:22-06:00">
</head>
<body>
    <!-- FIXME: reenable <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a> -->
    <section class="section"><div class="container">
            
    <nav id="nav-main" class="nav"><div id="nav-name" class="nav-left">
        
<a id="nav-anchor" class="nav-item" href="../../../../" title="Trevor Manternach" rel="home">
    <h1 id="nav-heading" class="title is-4">
        <span id="blog-title">Trevor Manternach</span>
    </h1>
</a>

      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" href="../../../../archive.html">Archive</a>
            <a class="level-item" href="../../../../about/">About</a>
            <a class="level-item" href="../../../../blogroll/">Blogroll</a>
            <a class="level-item" href="../../../../feed.xml">RSS</a>

    

    
    
    </nav><div class="searchform" role="search">
                    
 <!-- DuckDuckGo custom search -->
 <form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://trevormanternach.com/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;">
</form>
 <!-- End of custom search -->
 
              </div>
            
        
      </div>
    </nav>
</div>
    </section><section class="section"><div class="container">
            
    <h2 class="subtitle is-6 date">Aug 17, 2023 7:35 PM</h2>
    <h1 class="title"><a href=".">Control Palo Alto GlobalProtect VPN using AppleScript</a></h1>
    <div class="content">
        <p>I know it's a little strange to still be writing AppleScript in 2023, but this was the best way I found to easily connect and disconnect from a GlobalProtect VPN "automatically". I trigger this from a Keyboard Maestro shortcut, you are free to trigger it any way you wish!</p>
<p>This is a simple script that will toggle the connect/disconnect state of GlobalProtect on macOS. Tested with the latest version of GlobalProtect (v6.2.0-89) and macOS Ventura (13.4.1).:</p>
<pre class="literal-block">(*
Toggle GlobalProtect VPN with AppleScript
Tested using macOS Ventura 13.4.1 and GlobalProtect version 6.2.0-89
Written by Trevor Manternach, August 2023.
*)

tell application "System Events" to tell process "GlobalProtect"
  click menu bar item 1 of menu bar 2
  set statusText to name of static text 1 of window 1
  if statusText is "Not Connected" then
    # GlobalProtect is disconnected, so let's connect
    click button "Connect" of window 1
    set entireContents to entire contents of window 1
  else if statusText is "Connected" then
    # GlobalProtect is connected, so let's disconnect
    set windowText to entire contents of window 1
    repeat with theItem in windowText
      if (class of theItem is button) then
        if (value of attribute "AXTitle" of theItem is "Disconnect") then
          # We found a Disconnect button on the main page, let's click it.
          click theItem
          exit repeat
        else
          # We did not find a Disconnect button on the main page, let's hope there is one in the Settings Menu.
          click button "Global Protect Options Menu" of window 1
          click menu item "Disconnect" of menu "Global Protect Options Menu" of button "Global Protect Options Menu" of window 1
          exit repeat
        end if
      end if
    end repeat
  end if
  click menu bar item 1 of menu bar 2
end tell</pre>
<p>I also have this hosted as a <a class="reference external" href="https://gist.github.com/tmanternach/cbd4c213eab8569e38d6cd021b6255e5">gist</a> on github. Any changes I make to it are more likely to end up there than here. Comments are welcome over there, too!</p>
    </div>
    

    
    



            
        <footer id="footer"><p>Contents © 2025         <a href="mailto:trevor@trevormanternach.com">Trevor Manternach</a> </p>
            
        </footer>
</div>
    </section><script src="../../../../assets/js/all.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
