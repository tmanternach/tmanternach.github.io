<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is my personal weblog.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trevor Manternach</title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="assets/css/bootblog.css" rel="stylesheet" type="text/css">
<link href="assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#d63900">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="feed.xml">
<link rel="canonical" href="https://trevormanternach.com/">
<link rel="next" href="index-1.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="2023/11/10/routing-wireguard-networks-with-ospf-on-linux/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href=".">

            <span id="blog-title">Trevor Manternach</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<div class="searchform" role="search">
                      
 <!-- DuckDuckGo custom search -->
 <form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
 <input type="hidden" name="sites" value="https://trevormanternach.com/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Searchâ€¦" class="span2" style="margin-top: 4px;">
</form>
 <!-- End of custom search -->
 
                      </div>
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="about/" class="nav-link">About</a>
                </li>
<li class="nav-item">
<a href="blogroll/" class="nav-link">Blogroll</a>
                </li>
<li class="nav-item">
<a href="feed.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
    
        

    
        
    <div class="postindex">
            <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2023/11/10/routing-wireguard-networks-with-ospf-on-linux/" class="u-url">Routing Wireguard networks with OSPF on Linux</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2023/11/10/routing-wireguard-networks-with-ospf-on-linux/" rel="bookmark">
            <time class="published dt-published" datetime="2023-11-10T16:46:25-07:00" itemprop="datePublished" title="Nov 10, 2023 4:46 PM">Nov 10, 2023 4:46 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2023/11/10/routing-wireguard-networks-with-ospf-on-linux/#disqus_thread" data-disqus-identifier="cache/posts/2023/11/10/routing-wireguard-networks-with-ospf-on-linux.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I have a couple of Linux servers whose main purpose is to serve as a <a class="reference external" href="https://en.wikipedia.org/wiki/WireGuard">Wireguard</a> server. The peers on these servers are a combination of pure clients (like a mobile phone or laptop) and more traditional site-to-site tunnel connections (like a router at a remote location). The site-to-site connections usually are routing a remote network over the wireguard tunnel, something like a /24 network so you can access the far site's local network.</p>
<p>Wireguard makes this easy to do, you just add the /24 network as an "AllowedIP" for that peer. Wireguard does the work of adding that route to the routing table on the Linux server itself. If this Wireguard server is part of a more complex network, though, you need to be sending these remote networks to your Wireguard server so everyone can access them, not just those using Wireguard. I have been forced to add static routes on my main router to point those networks to my Wireguard servers.</p>
<p>Enter OSPF! If you are reading this, I am going to assume you know what OSPF is and why it's preferred over static routing. What follows is the steps I took to get my Wireguard "AllowedIPs" network automatically advertised to my main router using OSPF.</p>
<section id="install-frr"><h2>Install FRR</h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/FRRouting">FRR</a> is a Linux package that implements a lot of networking routing protocols. On your server running Wireguard (I'm assuming Debian/Ubuntu), running  <code class="docutils literal">apt get install <span class="pre">-y</span> frr</code>  gets everything you need installed. This includes a <code class="docutils literal">vtysh</code> command that dumps you into a Cisco IOS-like terminal to configure your OSPF routing.</p>
</section><section id="enable-ospf-daemon"><h2>Enable OSPF daemon</h2>
<p>Before configuring OSPF, you must enable the ospfd daemon in the FRR config. Edit <code class="docutils literal">/etc/frr/daemons</code> and change the <cite>ospfd=no`</cite> line to read <code class="docutils literal">ospfd=yes</code>. Then <code class="docutils literal">systemctl restart frr</code> is needed to restart FRR with OSPF enabled.</p>
</section><section id="configure-ospf-inside-frr"><h2>Configure OSPF inside FRR</h2>
<p>Run <code class="docutils literal">vtysh</code> to enter the FRR VTY interface. <code class="docutils literal">config terminal</code> to enter configuration mode. Here is the simplest configuration required to enable OSPF:</p>
<pre class="literal-block">interface ens160
  ip ospf network point-to-point
!
router ospf
  ospf router-id 192.168.0.0
  redistribute kernel
  redistribute connected
  network 192.168.0.0/31 area 0</pre>
<p>Here is the same config with my comments explaining the important parts:</p>
<pre class="literal-block">interface ens160 # this is your linux interface that is facing your main router.
  ip ospf network point-to-point # I am using a point-to-point style OSPF network, yours might be a broadcast type.
!
router ospf
  ospf router-id 192.168.0.0 # this could be anything, but traditionally this is your LAN IP of this wireguard server
  redistribute kernel # this was the tricky part. This is required to insert the Wireguard "AllowedIPs" networks into OSPF
  redistribute connected # this is required to insert your wg0 (and other) networks in OSPF
  network 192.168.0.0/31 area 0 # this is your LAN network for this wireguard server. Whatever is assigned to ens160 in my case. This is required to establish a neighbor relationship with my router.</pre>
<p>This guide doesn't cover any of the OSPF configuration on your main router. There are far too many different routers out there to even attempt to cover. The main trick to getting all of this working was stumbling across the <code class="docutils literal">redistribute kernel</code> command. I was familiar with the <code class="docutils literal">redisribute static</code> and <code class="docutils literal">redistribute connected</code> commands from administering Cisco IOS, but the way that Wireguard inserts these routes into the routing table requires use of this <code class="docutils literal">redistribute kernel</code> command.</p>
</section><section id="save-your-changes"><h2>Save your changes</h2>
<p>That's it! You can <code class="docutils literal">end</code> and then <code class="docutils literal">write memory</code> to save your configuration to <code class="docutils literal">/etc/frr/frr.conf</code>. If you miss this part, all of this configuration will be erased when FRR is restarted.</p>
</section><section id="troubleshooting"><h2>Troubleshooting</h2>
<p>Here are a couple of commands I used in the <code class="docutils literal">vtysh</code> interface to verify my configuration.</p>
<ul class="simple">
<li><p><code class="docutils literal">show ip ospf neighbor</code> - this should return a record showing your neighbor relationship with your main router</p></li>
<li><p><code class="docutils literal">show ip route kernel</code> - this should return all of your AllowedIPs networks that you have configured in Wireguard. These are the networks we are redistributing over OSPF.</p></li>
<li><p><code class="docutils literal">show ip ospf interface</code> - this should return a record indicating <code class="docutils literal">ens160 is up</code>, or whatever your LAN interface on your Wireguard server is. You can also see neighbor count here, which should be 1 in a point-to-point OSPF network.</p></li>
</ul></section>
</div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2023/11/03/python-script-to-retrieve-dhcp-leases-from-palo-alto-firewall/" class="u-url">Python script to retrieve DHCP leases from Palo Alto firewall</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2023/11/03/python-script-to-retrieve-dhcp-leases-from-palo-alto-firewall/" rel="bookmark">
            <time class="published dt-published" datetime="2023-11-03T16:50:34-06:00" itemprop="datePublished" title="Nov 3, 2023 4:50 PM">Nov 3, 2023 4:50 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2023/11/03/python-script-to-retrieve-dhcp-leases-from-palo-alto-firewall/#disqus_thread" data-disqus-identifier="cache/posts/2023/11/03/python-script-to-retrieve-dhcp-leases-from-palo-alto-firewall.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I have been using a Palo Alto PA-220 firewall for my home router for years. It is my DHCP server for my LAN. I often find myself needing to view the DHCP leases to see what IP address some random device (WLED, ESPHome devices, etc.) has. The web interface for the PA-220 is unbearably slow and the SSH CLI takes 30+ seconds after login to give me a prompt.</p>
<p>To speed up this task, I wrote this fairly simple script using python3. It uses the REST API that PAN-OS has to retrieve the DHCP leases. This script completes for me in less than 1 second. It outputs a JSON object. This works best for me as I find JSON to be humanly-readable and also allows me to pipe it to a utility like <cite>jq</cite> to filter it quickly.</p>
<p>Here is the code:</p>
<pre class="literal-block">import requests
import json
from xmltodict import parse, ParsingInterrupted
from urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

host = "192.168.2.1" # IP of Palo-Alto firewall goes here.
key = "KEY_GOES_HERE" # Run `curl -X GET 'https://&lt;host&gt;/api/?type=keygen&amp;user=&lt;username&gt;&amp;password=&lt;password&gt;'` to create API key.
interface = "ethernet1/2" # can also use "all"

def get_dhcp_leases(host, key, interface):
url = "https://{host}/api/?type=op&amp;cmd=&lt;show&gt;&lt;dhcp&gt;&lt;server&gt;&lt;lease&gt;&lt;interface&gt;{interface}&lt;/interface&gt;&lt;/lease&gt;&lt;/server&gt;&lt;/dhcp&gt;&lt;/show&gt;&amp;key={key}".format(host=host, key=key, interface=interface)
response = requests.get(url,verify=False)
return response

if __name__ == "__main__":
dhcp_leases = get_dhcp_leases(host, key, interface)
data = parse(dhcp_leases.content)
entries = data['response']['result']
print(json.dumps(entries, indent=4))</pre>
<p>I also have this hosted as a <a class="reference external" href="https://gist.github.com/tmanternach/21e3bba23261cbd5bacba2e50588acf6">gist</a> on github. Any changes I make to it are more likely to end up there than here. Comments are welcome over there, too!</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript/" class="u-url">Control Palo Alto GlobalProtect VPN using AppleScript</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-08-17T19:35:22-06:00" itemprop="datePublished" title="Aug 17, 2023 7:35 PM">Aug 17, 2023 7:35 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript/#disqus_thread" data-disqus-identifier="cache/posts/2023/08/17/control-palo-alto-globalprotect-vpn-using-applescript.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I know it's a little strange to still be writing AppleScript in 2023, but this was the best way I found to easily connect and disconnect from a GlobalProtect VPN "automatically". I trigger this from a Keyboard Maestro shortcut, you are free to trigger it any way you wish!</p>
<p>This is a simple script that will toggle the connect/disconnect state of GlobalProtect on macOS. Tested with the latest version of GlobalProtect (v6.2.0-89) and macOS Ventura (13.4.1).:</p>
<pre class="literal-block">(*
Toggle GlobalProtect VPN with AppleScript
Tested using macOS Ventura 13.4.1 and GlobalProtect version 6.2.0-89
Written by Trevor Manternach, August 2023.
*)

tell application "System Events" to tell process "GlobalProtect"
  click menu bar item 1 of menu bar 2
  set statusText to name of static text 1 of window 1
  if statusText is "Not Connected" then
    # GlobalProtect is disconnected, so let's connect
    click button "Connect" of window 1
    set entireContents to entire contents of window 1
  else if statusText is "Connected" then
    # GlobalProtect is connected, so let's disconnect
    set windowText to entire contents of window 1
    repeat with theItem in windowText
      if (class of theItem is button) then
        if (value of attribute "AXTitle" of theItem is "Disconnect") then
          # We found a Disconnect button on the main page, let's click it.
          click theItem
          exit repeat
        else
          # We did not find a Disconnect button on the main page, let's hope there is one in the Settings Menu.
          click button "Global Protect Options Menu" of window 1
          click menu item "Disconnect" of menu "Global Protect Options Menu" of button "Global Protect Options Menu" of window 1
          exit repeat
        end if
      end if
    end repeat
  end if
  click menu bar item 1 of menu bar 2
end tell</pre>
<p>I also have this hosted as a <a class="reference external" href="https://gist.github.com/tmanternach/cbd4c213eab8569e38d6cd021b6255e5">gist</a> on github. Any changes I make to it are more likely to end up there than here. Comments are welcome over there, too!</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2023/08/04/home-assistant-quick-bar/" class="u-url">Home Assistant Quick Bar</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2023/08/04/home-assistant-quick-bar/" rel="bookmark">
            <time class="published dt-published" datetime="2023-08-04T17:00:00-06:00" itemprop="datePublished" title="Aug 4, 2023 5:00 PM">Aug 4, 2023 5:00 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2023/08/04/home-assistant-quick-bar/#disqus_thread" data-disqus-identifier="cache/posts/2023/08/04/home-assistant-quick-bar.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I discovered that <a class="reference external" href="https://www.home-assistant.io/">Home Assistant</a> has a not-so-recent feature called "<a class="reference external" href="https://www.home-assistant.io/docs/tools/quick-bar/">Quick Bar</a>" that I somehow missed when it was released in 2020. In short, it allows you to press the <cite>e</cite> (for entity search) or <cite>c</cite> (for command search) anywhere in the Home Assistant web interface to access a Spotlight-style search box. This allows you access settings and devices in Home Assistant with just a few keystrokes.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2023/07/09/trying-out-nikola.html" class="u-url">Trying out Nikola</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2023/07/09/trying-out-nikola.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-07-09T20:11:29-06:00" itemprop="datePublished" title="Jul 9, 2023 8:11 PM">Jul 9, 2023 8:11 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2023/07/09/trying-out-nikola.html#disqus_thread" data-disqus-identifier="cache/posts/2023/07/09/trying-out-nikola.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I discovered a new static site generator today, <a class="reference external" href="https://getnikola.com/">Nikola</a>.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2022/11/25/audiobooks.html" class="u-url">Audiobooks</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2022/11/25/audiobooks.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-11-25T18:39:11-06:00" itemprop="datePublished" title="Nov 25, 2022 6:39 PM">Nov 25, 2022 6:39 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2022/11/25/audiobooks.html#disqus_thread" data-disqus-identifier="cache/posts/2022/11/25/audiobooks.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>Itâ€™s been years since I last paid for an Audible.com subscription. I just signed up this week ($5/month for 3 months) and itâ€™s been a delight so far. I discovered that you can pretty easily remove the DRM on the audiobook .aax file. I am using <a href="https://audible-converter.ml/">Audible Tools</a> to help me create the ffmpeg command to do this.</p>
<p>Another recent discovery is that <a href="https://overcast.fm/">Overcast</a>, my podcast player of choice, seems to natively support .m4b files (audiobook file format). It even includes artwork and chapters, so it behaves just like most of the podcasts I listen to.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2022/08/18/the-earliest-photo.html" class="u-url">1997 Photo at computer</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2022/08/18/the-earliest-photo.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-08-18T10:35:00-06:00" itemprop="datePublished" title="Aug 18, 2022 10:35 AM">Aug 18, 2022 10:35 AM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2022/08/18/the-earliest-photo.html#disqus_thread" data-disqus-identifier="cache/posts/2022/08/18/1997-photo-at-computer.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>The earliest photo I have of me at a computer. Circa 1997!</p>
<img alt="/images/1997-Trevor.jpg" src="images/1997-Trevor.jpg">
</div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2022/06/04/my-ipod-history.html" class="u-url">My iPod history</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2022/06/04/my-ipod-history.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-06-04T07:41:00-06:00" itemprop="datePublished" title="Jun 4, 2022 7:41 AM">Jun 4, 2022 7:41 AM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2022/06/04/my-ipod-history.html#disqus_thread" data-disqus-identifier="cache/posts/2022/06/04/my-ipod-history.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>Last month Apple <a href="https://www.apple.com/newsroom/2022/05/the-music-lives-on/">announced</a> the end of the iPod. I thought it might be fun to document my history with the product.</p>
<p>--</p>
<p>I got my first iPod in March 2005. I believe I bought mine at Best Buy on a weekend trip 350 miles away from home.</p>
<p><img src="images/4th-Gen-iPod.jpg" width="600" alt="Picture of my first iPod"></p>
<p>I was listening to a lot of podcasts in those early days and had to use <a href="https://en.wikipedia.org/wiki/Juice_(aggregator)">"podcatcher" software</a> because iTunes didn't support podcasts yet. That changed later that year when <a href="https://en.wikipedia.org/wiki/History_of_iTunes#iTunes_4">iTunes 4.9</a> added podcasts and the rest is history.</p>
<p>I visited that same Best Buy a couple years later when the iPod Touch was released. I remember checking their website and they said they had them in stock, but when I got to the store I couldn't find them. I finally asked and they were still in the back, they went and got one for me.</p>
<p><img src="images/iPod-Touch.jpg" width="600" height="450" alt="My first iPod Touch"></p>
<p>The iPod Touch was so much fun back then. The iPhone wasn't "in" Montana back then (no joke) and so the Touch was as close as I could get. I remember jailbreaking the thing, and even hanging out in IRC chatrooms trying to troubleshoot my jailbreak attempts. :-D</p>
<p>This past winter I spent ~$100 on new parts to revive my old 4th gen iPod. It now has new life with <a href="https://www.ifixit.com/Store/iPod/iPod-4G-Photo-Battery/IF193-016?o=3">a fresh battery</a> and <a href="https://www.iflash.xyz/store/iflash-solo/">an SD card</a> in place of the 20GB spinning hard drive. It's hard to believe a piece of consumer technology from 17 years ago is still alive and well.</p>
<p>I love iPod. It was one of my first adventures into a lifetime of technology.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2022/04/30/adguard-wildcard-dns-with-nginx-proxy-manager.html" class="u-url">AdGuard Wildcard DNS with Nginx Proxy Manager</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2022/04/30/adguard-wildcard-dns-with-nginx-proxy-manager.html" rel="bookmark">
            <time class="published dt-published" datetime="2022-04-30T20:59:42-06:00" itemprop="datePublished" title="Apr 30, 2022 8:59 PM">Apr 30, 2022 8:59 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2022/04/30/adguard-wildcard-dns-with-nginx-proxy-manager.html#disqus_thread" data-disqus-identifier="cache/posts/2022/04/30/adguard-wildcard-dns-with-nginx-proxy-manager.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p>I started using Nginx Proxy Manger at home recently and found a fast and easy way to add internal domains to it. Here is a simple walkthrough.</p>
<h4>Prerequisites</h4>
<ul>
<li>You need to be using <a href="https://adguard.com/en/adguard-home/overview.html">AdGuard Home</a> for DNS</li>
<li>You want to quickly add new domains to <a href="https://nginxproxymanager.com/">Nginx Proxy Manager</a>
</li>
</ul>
<h4>AdGuard Home setup</h4>
<p>In the AdGuard Home web interface, go to Filters-&gt;DNS rewrites.</p>
<p><img alt="Screenshot of DNS rewrite options on AdGuard Home" src="images/adguard-1.png" title="Screenshot of DNS rewrite options on AdGuard Home"></p>
<p>Click <strong>Add DNS rewrite</strong> and enter something like <em>*.home</em> in the domain name field.</p>
<p>Enter the IP address of your NPM host and click <strong>Save</strong>.</p>
<h4>Nginx Proxy Manager</h4>
<p><img alt="Screenshot of Nginx Proxy Manager" src="images/nginx-1.png" title="Screenshot of Nginx Proxy Manager"></p>
<p>There really isn't anything special to do in NPM. Just add a Proxy Host and in the domain names field you can enter anything as long as it ends in .home (or whatever you chose for a wildcard). www.home even works!</p>
<p>Another little feature I discovered while setting this up is that I can add multiple domain names for each proxy host. So <em>adguard.home</em> and <em>dns.home</em> can both get me to the same place. This helps when I can't remember the name of a service, or when you change software you can keep using something like <em>dashboard.home</em> for your <a href="https://github.com/bastienwirtz/homer">dashboard of choice</a>.</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="2020/books-ive-read/" class="u-url">2020 Books I've Read</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        Trevor Manternach
                    </span></p>
            <p class="dateline">
            <a href="2020/books-ive-read/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-01T16:08:51-06:00" itemprop="datePublished" title="Jan 1, 2020 4:08 PM">Jan 1, 2020 4:08 PM</time></a>
            </p>
                        <p class="commentline">
    
    <a href="2020/books-ive-read/#disqus_thread" data-disqus-identifier="cache/posts/2020/2020-books-ive-read.html">Comments</a>


                </p>
</div>
            </header><div class="p-summary entry-summary">
                    <p><a href="https://www.goodreads.com/book/show/13538641-killing-kennedy" target="_blank"><em>Killing Kennedy: The End of Camelot</em></a><br>
8 hours 25 minutes. Started January 11. Finished January 16th.</p>
<p><a href="https://www.goodreads.com/book/show/10587120-killing-lincoln" target="_blank"><em>Killing Lincoln</em></a><br>
7 hours 49 minutes. Started June 7th. Finished June 15th.</p>
<p><a href="https://www.goodreads.com/book/show/52836282-true-crimes-and-misdemeanors" target="_blank"><em>True Crimes and Misdemeanors: The Investigation of Donald Trump</em></a><br>
496 pages. Started August 18th. Finished October 1st.</p>
<p><a href="https://www.goodreads.com/book/show/54545843-where-law-ends" target="_blank"><em>Where Law Ends: Inside the Mueller Investigation</em></a><br>
432 pages. Started October 1st. Finished October 27th.</p>
<p><a href="https://www.goodreads.com/book/show/24583081-battle-for-the-big-sky" target="_blank"><em>Battle for the Big Sky</em></a><br>
286 pages. Started October 28th. Finished November 25th.</p>
<p><a href="https://www.goodreads.com/book/show/244909.The_Conscience_of_a_Conservative" target="_blank"><em>The Conscience of a Conservative</em></a><br>
144 pages. Started November 26th. Finished November 28th.</p>
<p><a href="https://www.goodreads.com/book/show/36204293-the-war-on-normal-people" target="_blank"><em>The War on Normal People</em></a><br>
304 pages. Started November 28th. Finished December 2nd.</p>
                </div>
            </article>
</div>
    
        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-1.html" rel="next">Older posts</a></li>
        </ul>
<script>var disqus_shortname="trevormanternach-com";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents Â© 2023         <a href="mailto:trevor@trevormanternach.com">Trevor Manternach</a> 
            
            
        </footer>
</div>
</div>


            <script src="assets/js/jquery.min.js"></script><script src="assets/js/popper.min.js"></script><script src="assets/js/bootstrap.min.js"></script><script src="assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
